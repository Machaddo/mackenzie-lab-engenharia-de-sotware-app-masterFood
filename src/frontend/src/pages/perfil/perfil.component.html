<ng-container *ngIf="currentUser$ | async as user; else defaultAvatar">
  <div class="container-fluid perfil-main-area">
    <!-- SeÃ§Ã£o do UsuÃ¡rio + BotÃ£o de Logout alinhado -->
    <div
      class="user-header d-flex justify-content-between align-items-center mb-4"
    >
      <!-- Info do usuÃ¡rio -->
      <section class="user-info-section d-flex align-items-center gap-4 m-0">
        <div class="profile-avatar position-relative">
          <div class="circular-avatar-wrapper">
            <div class="avatar-initial-text">
              {{ user.name.charAt(0).toUpperCase() }}
            </div>
          </div>
        </div>

        <div class="user-details">
          <h2 class="fw-bold mb-1">OlÃ¡, {{ user.name | titlecase }} ğŸ‘‹</h2>
          <span class="badge bg-primary">
            Receitas Criadas: {{ user.recipes?.length || 0 }}
          </span>
        </div>
      </section>

      <!-- BotÃ£o Logout -->
      <button
        class="btn btn-outline-danger btn-sm logout-btn d-flex align-items-center gap-2"
        (click)="logout()"
      >
        <i class="bi bi-box-arrow-right"></i>
        Sair
      </button>
    </div>

    <!-- Cards -->
    <div class="row g-3 card-grid">
      <!-- Minha Conta -->
      <div class="col-6 col-md-4">
        <div class="card p-3 h-100" (click)="openEditModal('conta')">
          <h6
            class="card-title fw-bold d-flex justify-content-between align-items-center"
          >
            Minha Conta
            <i class="bi bi-eye text-secondary cursor-pointer fs-6"></i>
          </h6>
          <p class="mb-1"><i class="bi bi-person me-2"></i>{{ user.name }}</p>
          <p class="mb-0">
            <i class="bi bi-envelope me-2"></i>{{ user.login }}
          </p>
        </div>
      </div>

      <!-- Ingredientes -->
      <!-- <div class="col-6 col-md-4">
        <div class="card p-3 h-100" (click)="openEditModal('ingredientes')">
          <h6 class="card-title fw-bold d-flex justify-content-between align-items-center">
            Ingredientes
            <i class="bi bi-pencil-square text-primary fs-6"></i>
          </h6>
          <p class="mb-0">Gerencie suas restriÃ§Ãµes alimentares</p>
        </div>
      </div> -->

      <!-- Minhas Receitas -->
      <div class="col-6 col-md-4" *ngIf="user.recipes">
        <div class="card p-3 h-100" (click)="goToRecipes()">
          <h6
            class="card-title fw-bold d-flex justify-content-between align-items-center"
          >
            Minhas Receitas
            <i class="bi bi-book text-success fs-5"></i>
          </h6>
          <p class="mb-0">
            VocÃª possui {{ user.recipes.length }} receitas cadastradas
          </p>
        </div>
      </div>
    </div>

    <!-- Ãšltimas Receitas -->
    <div *ngIf="user.recipes?.length" class="mt-4">
      <h5 class="fw-bold mb-3">Ãšltimas Receitas</h5>

      <div class="last-recipes-list">
        <div
          class="recipe-item"
          *ngFor="let r of user.recipes | slice : 0 : 3"
          (click)="goToRecipe(r)"
        >
          <i class="bi bi-journal-text me-2"></i>
          <span>{{ r.name }}</span>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<ng-template #defaultAvatar>
  <div class="container-fluid perfil-main-area">
    Ocorreu um erro. Tente novamente em alguns minutos...
  </div>
</ng-template>
